{"ast":null,"code":"var _jsxFileName = \"/Users/user/Downloads/myapp/src/containers/EventsContext.js\";\nimport React from \"react\";\nimport axios from \"../config/axios\";\nconst EventContext = React.createContext();\nconst ApiEndpoint = {\n  coach: \"/api/v1/associated_coach\",\n  activity: \"api/v1/meta-activity\"\n};\n\nconst EventProvider = props => {\n  const [events, setEvents] = React.useState([]);\n  const [filter, setFilter] = React.useState({\n    min_date: \"2019-07-20\",\n    max_date: \"2019-07-30\"\n  });\n\n  const getCoach = async event => {\n    return await axios.get(`${ApiEndpoint.coach}/?company=6&id__in=${event === null || event === void 0 ? void 0 : event.coach}`).then(res => res.data[0]);\n  };\n\n  const getActivity = async event => {\n    return await axios.get(`${ApiEndpoint.activity}/${event === null || event === void 0 ? void 0 : event.meta_activity}`).then(res => res.data);\n  };\n\n  const getEvents = () => {\n    function renderQuery() {\n      if ((filter === null || filter === void 0 ? void 0 : filter.min_date) && (filter === null || filter === void 0 ? void 0 : filter.max_date)) return `/api/v1/offer/?company=6&min_date=${filter === null || filter === void 0 ? void 0 : filter.min_date}&max_date=${filter === null || filter === void 0 ? void 0 : filter.max_date}&page_size=10`;\n      return \"/api/v1/offer/?company=6&page_size=10\";\n    }\n\n    return new Promise((resolve, reject) => {\n      axios.get(renderQuery()).then(async response => {\n        let tab = [];\n        let res = response.data.results;\n\n        for (let index = 0; index < res.length; index++) {\n          const event = res[index];\n          Promise.all([getCoach(event), getActivity(event)]).then(([coach, activity]) => {\n            event.coach = coach;\n            event.meta_activity = activity;\n            tab.push(event);\n          });\n        }\n\n        setTimeout(() => {\n          resolve(tab);\n        }, 1000);\n      });\n    });\n  };\n\n  React.useEffect(() => {\n    getEvents().then(results => {\n      setEvents(results);\n    });\n  }, [filter]);\n\n  function handleChangeFilter({\n    target: {\n      name,\n      value\n    }\n  }) {\n    setFilter({ ...filter,\n      [name]: value\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(EventContext.Provider, {\n    value: {\n      events,\n      filter,\n      function: {\n        handleChangeFilter\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 3\n    }\n  }, props.children);\n};\n\nconst useEventContext = () => React.useContext(EventContext);\n\nexport { EventProvider, useEventContext };","map":{"version":3,"sources":["/Users/user/Downloads/myapp/src/containers/EventsContext.js"],"names":["React","axios","EventContext","createContext","ApiEndpoint","coach","activity","EventProvider","props","events","setEvents","useState","filter","setFilter","min_date","max_date","getCoach","event","get","then","res","data","getActivity","meta_activity","getEvents","renderQuery","Promise","resolve","reject","response","tab","results","index","length","all","push","setTimeout","useEffect","handleChangeFilter","target","name","value","function","children","useEventContext","useContext"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"../config/axios\";\nconst EventContext = React.createContext();\nconst ApiEndpoint = {\n\tcoach: \"/api/v1/associated_coach\",\n\tactivity: \"api/v1/meta-activity\",\n};\nconst EventProvider = (props) => {\n\tconst [events, setEvents] = React.useState([]);\n\tconst [filter, setFilter] = React.useState({\n\t\tmin_date: \"2019-07-20\",\n\t\tmax_date: \"2019-07-30\",\n\t});\n\tconst getCoach = async (event) => {\n\t\treturn await axios\n\t\t\t.get(`${ApiEndpoint.coach}/?company=6&id__in=${event?.coach}`)\n\t\t\t.then((res) => res.data[0]);\n\t};\n\tconst getActivity = async (event) => {\n\t\treturn await axios\n\t\t\t.get(`${ApiEndpoint.activity}/${event?.meta_activity}`)\n\t\t\t.then((res) => res.data);\n\t};\n\tconst getEvents =()=>{\n\t\tfunction renderQuery() {\n\t\t\tif (filter?.min_date && filter?.max_date)\n\t\t\t\treturn `/api/v1/offer/?company=6&min_date=${filter?.min_date}&max_date=${filter?.max_date}&page_size=10`;\n\t\t\treturn \"/api/v1/offer/?company=6&page_size=10\";\n\t\t}\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\taxios.get(renderQuery()).then(async (response) => {\n\t\t\t\tlet tab =[];\n\t\t\t\tlet res= response.data.results;\n\t\t\t\tfor (let index = 0; index < res.length; index++) {\n\t\t\t\t\tconst event = res[index];\n\t\t\t\t\tPromise.all([\n\t\t\t\t\t\tgetCoach(event),\n\t\t\t\t\t\tgetActivity(event),\n\t\t\t\t\t]).then(([coach,activity]) => {\n\t\t\t\t\t\tevent.coach =coach;\n\t\t\t\t\t\tevent.meta_activity =activity;\n\t\t\t\t\t\ttab.push(event);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\tresolve(tab)\n\t\t\t\t},1000)\n\t\t\t\t\n\t\t\t});\n\t\t})\n\t}\n\tReact.useEffect(() => {\n\t\tgetEvents().then(results=>{\n\t\t\tsetEvents(results);\n\t\t})\n\n\t}, [filter]);\n\n\tfunction handleChangeFilter({ target: { name, value } }) {\n\t\tsetFilter({ ...filter, [name]: value });\n\t}\n\treturn (\n\t\t<EventContext.Provider\n\t\t\tvalue={{ events, filter, function: { handleChangeFilter } }}\n\t\t>\n\t\t\t{props.children}\n\t\t</EventContext.Provider>\n\t);\n};\nconst useEventContext = () => React.useContext(EventContext);\nexport { EventProvider, useEventContext };\n"]},"metadata":{},"sourceType":"module"}